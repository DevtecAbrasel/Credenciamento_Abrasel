<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lista de check-in</title>
  <meta name="viewport" content="width=device-width">
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"rel="stylesheet"/>
  <link rel="stylesheet" href="styles/style-list-checkin.css">
  
</head>
<body>

  <div class="all">
    <div class="buttons">
      <div class="one">
        <a href="login.html"><button class="curve overlay__btn overlay__btn--colors">Sair</button></a>
      </div>
    </div>
  </div>

  <canvas class="orb-canvas"></canvas>

  <section>
    <h1>Lista de check-in</h1>
  
    <!-- Adicionando o campo de busca -->
    <div class="search-container">
      <label for="search">Buscar convidado:</label>
      <input type="text" id="search" placeholder="Digite o nome do convidado">
    </div>

    <div class="wrapper-checkbox" id="checkboxContainer">
      <!-- Os checkboxes serão adicionados dinamicamente aqui -->
    </div>
  </section>

  <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src="list-checkin.js"></script>
  <script type="module">


document.addEventListener('DOMContentLoaded', function () {
  const searchInput = document.getElementById('search');
  const checkboxes = document.querySelectorAll('.checkbox');

  searchInput.addEventListener('input', function () {
    const searchTerm = searchInput.value.toLowerCase();

    checkboxes.forEach(function (checkbox) {
      const guestName = checkbox.querySelector('.text span').textContent.toLowerCase();

      if (guestName.includes(searchTerm)) {
        checkbox.style.display = 'block';
      } else {
        checkbox.style.display = 'none';
      }
    });
  });
});

document.addEventListener("DOMContentLoaded", async function () {
  try {
    const events = await fetchEvents();
    console.log("Eventos recebidos:", events);
    updateCheckboxes(events);
  } catch (error) {
    console.error("Erro durante a obtenção de eventos:", error.message);
  }
});

async function fetchEvents() {
  const apiUrl = "http://localhost:8080/v1/invitee";

  try {
    const response = await fetch(apiUrl, {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${localStorage.getItem("token")}`,
      },
    });

    if (!response.ok) {
      throw new Error(`Erro na requisição: ${response.status}`);
    }

    const data = await response.json();
    return data;
  } catch (error) {
    console.error("Erro durante a solicitação fetch:", error.message);
    throw error;
  }
}

function updateCheckboxes(events) {
  const checkboxContainer = document.getElementById("checkboxContainer");

  // Clear the container before adding the new checkboxes
  checkboxContainer.innerHTML = "";

  events.forEach((invitee, index) => {
    // Create a new checkbox for each event
    const checkbox = document.createElement("div");
    checkbox.classList.add("checkbox");

    // Add relevant data to the checkbox
    checkbox.innerHTML = `
      <div class="figure-container">
        <div class="figure face"></div>
      </div>
      <div class="text">
        <span id="name${index}">${invitee.name}
        <br>
        <span id="role${index}" style="margin-left:-10px">${invitee.role},</span>
        <span id="company${index}" style="margin-left:30px">${invitee.company}</span>
      </div>
    `;

    // Add the checkbox to the container
    checkboxContainer.appendChild(checkbox);
  });
}

  </script>
</body>
</html>

<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lista de check-in</title>
  <meta name="viewport" content="width=device-width">
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"rel="stylesheet"/>
  <link rel="stylesheet" href="styles/style-list-checkin.css">
  <style>
    /* Adicione estilos adicionais conforme necessário */
    .search-container {
      margin-bottom: 15px;
    }

    label {
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <div class="all">
    <div class="buttons">
      <div class="one">
        <a href="login.html"><button class="curve overlay__btn overlay__btn--colors">Sair</button></a>
      </div>
    </div>
  </div>

  <canvas class="orb-canvas"></canvas>

  <section>
    <h1>Lista de check-in</h1>
  
     Adicionando o campo de busca 
    <div class="search-container">
      <label for="search">Buscar convidado:</label>
      <input type="text" id="search" placeholder="Digite o nome do convidado">
    </div>

    <div class="wrapper-checkbox">
      <div class="checkbox">
        <div class="figure-container">
          <div class="figure face"></div>
        </div>
        <div class="text">
          <span>Convidado 1
            <br>
            Cargo,
            Empresa,
            Mesa
          </span>
        </div>
      </div>
      <div class="checkbox">
        <div class="figure-container">
          <div class="figure face"></div>
        </div>
        <div class="text">
          <span>Convidado 2
            <br>
            Cargo,
            Empresa,
            Mesa
          </span>
        </div>
      </div>
      <div class="checkbox">
        <div class="figure-container">
          <div class="figure face"></div>  
        </div>
        <div class="text"> 
          <span>Convidado 3
            <br>
            Cargo,
            Empresa,
            Mesa
          </span>
        </div>
      </div>
      <div class="checkbox">
        <div class="figure-container">
          <div class="figure face"></div>
        </div>
        <div class="text">
          <span>Convidado 4
            <br>
            Cargo,
            Empresa,
            Mesa
          </span> 
        </div> 
      </div>
    </div>
  </section>

  <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src="list-checkin.js"></script>
  <script type="module" src="list-checkin.js"></script>
</body>
</html> -->